# 251019 TIL

## 불변성(Immutability)의 중요성과 구현 방법은 무엇인가요?

### 불변성
- 객체가 한 번 생성된 후에는 그 상태를 영원히 변경할 수 없는 특성

1. 중요성
| 이점 | 설명 |
|------|------|
| **스레드 안전성 (Thread Safety)** | 상태가 변경될 수 없으므로, 여러 스레드가 별도의 동기화 없이도 안전하게 객체를 공유할 수 있습니다. |
| **예측 가능한 동작 (Predictable Behavior)** | 객체의 상태가 생성 후 일정하게 유지되어, 예상치 못한 부작용(Side-effect)을 방지하고 코드의 이해 및 디버깅이 용이합니다. |
| **해시 기반 컬렉션 키 활용 (Safe HashMap/HashSet Keys)** | 객체의 해시 코드(hashCode)가 생성 후 변하지 않기 때문에, HashMap이나 HashSet의 키로 사용하기에 적합합니다. |
| **캐싱 (Caching)** | 해시 코드를 안전하게 캐시할 수 있으며, 객체가 재사용될 수 있어 메모리 효율성과 성능을 개선하는 데 도움이 됩니다. |
| **보안 (Security)** | String 클래스의 불변성처럼, 파일 경로, URL, 민감한 데이터 등이 악의적인 변경으로부터 보호되어 보안 취약점을 줄일 수 있습니다. |


2. 구현방법
    1. 클래스를 `final`로 선언하여 상속을 막습니다. 
    2. 모든 필드는 `private final`로 선언하고, 생성자에서 한 번만 초기화합니다.
    3. 필드를 변경할 수 있는 setter나 수정 메서드를 제공하지 않습니다.
    4. 만약 필드가 `Date`, 컬렉션(List, Map 등)처럼 가변(mutable) 객체를 참조한다면, 생성자나 접근자(getter)에서 **방어적 복사(defensive copy)** 를 하거나 불변 타입을 사용해야 합니다.
    5. 내부 가변 상태가 외부로 노출되지 않도록 합니다. 예컨대 내부 List를 그대로 반환하지 않고 `Collections.unmodifiableList()` 혹은 복사본을 반환해야 합니다.

    ```Java
    public final class ImmutablePoint {
    private final int x;
    private final int y;
    
    public ImmutablePoint(int x, int y) { // 1. 생성자로 값 초기화
        this.x = x;
        this.y = y;
    }
    
    public int getX() { return x; }
    public int getY() { return y; }

    }

    ```

3. Java의 불변 클래스 예시
- java.lang.String
- 모든 래퍼 클래스 (Integer, Long, Boolean, Double 등)
- Java 8 이후의 날짜/시간 API (LocalDate, LocalTime, Instant 등)