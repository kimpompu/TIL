# 251223 TIL

# 오늘 한 일
 - 로컬실행용 `docker-compose.yaml` 작성

## Search Service 기동 실패

- 오류 메시지:`BeanCreationException, analyzer [nori] has not been configured`

1. 원인 : Elasticsearch 컨테이너에 한국어 형태소 분석기인 'Nori' 플러그인이 설치되지 않음.
2. 해결 : docker-compose.yml에서 Elasticsearch 컨테이너 실행 명령(command)을 수정하여 플러그인 자동 설치 로직 추가.

## Chat / Monitor Service DB 접속 불가
- 오류 메시지: `FATAL: database "chat_db" does not exist, GenericJDBCException`

- 원인: PostgreSQL 컨테이너는 기본적으로 하나의 DB만 생성함. 서비스별로 필요한 추가 DB(chat_db, monitor_db)가 없어 접속 거부됨.
- 해결: init.sql 스크립트를 작성하여 컨테이너 시작 시 필요한 모든 데이터베이스를 CREATE DATABASE 하도록 볼륨 마운트 설정.

## Feed Service 환경 변수 파싱 오류

- 오류 메시지: `Failed to bind properties ... java.lang.NumberFormatException: For input string: "${REDIS_PORT}"`
1. 원인: application.yaml에서 사용하는 ${REDIS_PORT} 변수가 Docker 컨테이너에 주입되지 않아, 문자열 그대로 인식됨.
2. 해결: docker-compose.yml의 feed-service 환경 변수에 REDIS_PORT: 6379를 명시적으로 추가.

## Gateway / User Service 실행 실패

- 오류 메시지: `Could not resolve placeholder 'JWT_SECRET_KEY'`
1. 원인: .env 파일에 정의된 보안 키가 docker-compose.yml을 통해 컨테이너 내부로 전달되지 않음.
2. 해결: docker-compose.yml의 environment 섹션에 JWT_SECRET_KEY: ${JWT_SECRET_KEY} 추가.

## 서비스 간 통신 거부(Connection Refused)

- 오류 메시지: `Connection to localhost:5432 refused, localhost:6379 refused`

1. 원인: Docker 컨테이너 내부에서 localhost는 자기 자신을 의미함. 외부 컨테이너(DB, Redis)에 접속하려면 서비스 이름을 사용해야 함.
2. 해결: docker-compose.yml에서 각 서비스의 접속 URL을 localhost 대신 **서비스 명(postgres-user, redis 등)**으로 재설정(Override).