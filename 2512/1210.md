# 251210 TIL

## 오류
| 구현 목표 | 고민 사항 | 해결 전략 |
| :--- | :--- | :--- |
| **리스트 처리 효율화** | Kafka로 수신자 리스트(`List<Long>`)를 받았을 때, DB 저장과 처리를 어떻게 할 것인가? | 1. **DTO 위임**: `NotificationKafkaDto` 내부에 `toEntities()` 메서드를 만들어 스스로 Entity List로 변환하도록 책임 부여.<br>2. **Bulk Insert**: Service에서 `repository.saveAll()`로 한 번에 저장.<br>3. **개별 발송**: 저장된 리스트를 `stream/forEach`로 순회하며 Redis로 개별 전송. |
| **로직 통합** | Kafka(비동기) 요청과 Feign(동기/HTTP) 요청의 처리 로직이 중복됨. | 1. **입구 통일**: Feign 요청 DTO(`RequestDto`)도 `receiverIds(List)`를 받도록 변경.<br>2. **파이프라인 통일**: Kafka와 Feign 모두 `toEntities()` -> `saveAndSend()` 흐름을 타도록 구조 일원화. |
