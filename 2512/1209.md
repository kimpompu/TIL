# 251209 TIL

## 오류 기록

| 오류 증상 | 원인 | 해결 방법 |
|----------|------|------------|
| UnknownHostException: null | @FeignClient(url = "/internal")처럼 url 속성에 경로만 적어서 호스트를 찾지 못함. | url 대신 path = "/internal" 속성으로 변경하여 Eureka 서비스 이름 기반 통신 적용. |
| 403 Forbidden | User Service의 Spring Security가 /internal/** 요청에 대해서도 인증 토큰을 요구함. | User Service SecurityConfig에서 /internal/** 경로는 permitAll()로 설정하여 내부 통신 허용. |
| JDBC URL 파싱 실패 (${DATABASE_PORT} 문자열 그대로 인식) | 환경변수가 주입되지 않아 설정 파일의 변수명(${...})이 치환되지 않음. | application.yml에 기본값 설정 (${DATABASE_PORT:5432}) 하여 환경변수 없이도 동작하게 수정. |
| DB 인증 실패 (FATAL: password authentication failed) | application.yml의 username과 실제 DB 유저가 다르거나, 해당 유저가 DB에 없었음. | DB 컨테이너에 접속하여 SQL로 userdb, feeduser 등의 계정을 직접 생성하고 권한 부여. |
| DB 컬럼 제약조건 위반 (null value in column "is_deleted") | JPA 엔티티는 is_deleted를 쓰는데, DB에는 deleted와 is_deleted 컬럼이 둘 다 존재(NOT NULL)하여 충돌. | 불필요하게 남아있던 deleted 컬럼을 DB에서 삭제 (ALTER TABLE ... DROP COLUMN). |
| 포트 충돌 (Bind for 0.0.0.0:6379 failed) | 기존 서비스(User/Feed)와 Chat 서비스의 Docker Compose가 동일한 호스트 포트를 사용하여 충돌. | Chat 서비스의 포트를 변경 (Postgres: 5434, Redis: 6381)하여 충돌 방지. |
| Redis 실행 실패 | docker-compose의 command에 --requirepass 옵션은 넣었으나 비밀번호 값을 안 넣음. | `command: ["redis-server", "--requirepass", "1234"]`로 비밀번호 명시. |


